package rsa;

/**
 * Created by DuThien on 22/03/2017.
 */
public class XOR {
    private static final int[] sf = {
            891, 169, 413, 90, 147, 325, 710, 925, 596, 723, 51, 373, 884, 409, 560, 389, 278, 590, 256, 274, 847, 228,
            776, 611, 400, 741, 256, 339, 91, 1010, 497, 955, 71, 884, 802, 565, 380, 335, 739, 902, 272, 212, 833, 504,
            86, 223, 34, 769, 953, 400, 620, 822, 76, 790, 962, 788, 863, 894, 393, 346, 201, 251, 632, 299, 40, 945,
            594, 575, 397, 825, 756, 834, 17, 97, 113, 236, 630, 22, 42, 455, 49, 980, 584, 818, 203, 285, 959, 365, 349,
            982, 170, 932, 369, 905, 272, 309, 83, 210, 68, 169, 489, 638, 4, 292, 793, 294, 215, 614, 656, 894, 47, 643,
            3, 583, 712, 84, 742, 1020, 483, 94, 47, 935, 166, 838, 328, 886, 104, 871, 667, 720, 314, 577, 304, 183,
            384, 314, 602, 96, 6, 609, 874, 468, 65, 48, 540, 665, 249, 754, 202, 380, 512, 360, 294, 370, 535, 454, 457,
            389, 970, 14, 9, 204, 639, 427, 291, 74, 22, 210, 658, 543, 921, 808, 222, 368, 701, 897, 280, 124, 51, 979,
            64, 301, 434, 938, 344, 292, 394, 334, 685, 544, 248, 620, 941, 154, 729, 331, 355, 905, 600, 147, 220, 780,
            521, 922, 304, 334, 861, 200, 897, 550, 861, 973, 447, 4, 781, 629, 10, 1007, 443, 387, 163, 10, 937, 266,
            858, 657, 745, 0, 563, 453, 306, 866, 620, 812, 411, 860, 701, 820, 744, 240, 556, 475, 110, 483, 66, 454,
            115, 904, 70, 700, 196, 324, 93, 263, 453, 707, 425, 633, 908, 215, 310, 97, 454, 930, 690, 116, 322, 831,
            320, 106, 705, 797, 821, 465, 920, 913, 276, 891, 738, 535, 186, 1007, 607, 201, 590, 397, 109, 350, 286,
            309, 630, 734, 157, 1018, 133, 550, 634, 883, 110, 802, 487, 966, 877, 934, 988, 358, 721, 714, 156, 484,
            980, 800, 225, 471, 131, 884, 569, 693, 104, 779, 697, 610, 312, 281, 461, 450, 814, 884, 1001, 969, 85, 853,
            1011, 733, 616, 524, 561, 732, 667, 885, 409, 28, 374, 826, 7, 737, 547, 94, 856, 943, 516, 294, 338, 295,
            281, 182, 307, 601, 32, 933, 660, 972, 918, 949, 958, 108, 451, 271, 98, 635, 562, 770, 496, 586, 807, 404,
            114, 471, 512, 891, 408, 983, 982, 908, 994, 996, 884, 929, 991, 1001, 1020, 396, 982, 564, 834, 589, 917,
            305, 648, 538, 74, 649, 30, 272, 324, 764, 209, 385, 352, 537, 1012, 741, 384, 542, 72, 387, 815, 692, 165,
            767, 135, 507, 721, 932, 373, 747, 127, 818, 100, 459, 1022, 748, 725, 368, 255, 362, 529, 827, 983, 510, 30,
            941, 857, 554, 541, 993, 392, 934, 511, 11, 707, 180, 449, 531, 942, 683, 808, 637, 7, 669, 823, 754, 378, 564,
            530, 55, 405, 409, 876, 757, 787, 151, 829, 83, 496, 457, 339, 860, 624, 1016, 104, 321, 734, 871, 188, 739,
            502, 276, 185, 87, 999, 837, 550, 160, 532, 964, 151, 111, 781, 384, 138, 40, 720, 154, 670, 447, 640, 386,
            102, 266, 472, 473, 859, 486, 889, 794, 470, 160, 694, 726, 832, 51, 506, 610, 72, 440, 272, 231, 364, 1009,
            606, 815, 87, 375, 844, 958, 278, 448, 1023, 551, 998, 593, 389, 477, 408, 24, 694, 280, 440, 1012, 587, 764,
            260, 545, 89, 700, 242, 85, 544, 1008, 436, 233, 954, 598, 693, 746, 870, 335, 40, 974, 842, 285, 685, 752,
            258, 759, 831, 948, 217, 856, 602, 421, 665, 463, 950, 298, 935, 1002, 421, 111, 310, 471, 117, 108, 798, 158,
            689, 602, 662, 1005, 1019, 254, 789, 410, 1009, 726, 75, 497, 621, 56, 540, 555, 442, 850, 545, 338, 827, 403,
            559, 855, 423, 964, 338, 46, 393, 1016, 181, 716, 690, 314, 979, 214, 691, 480, 98, 616, 526, 329, 811, 138,
            947, 72, 817, 291, 586, 204, 876, 491, 613, 454, 312, 813, 776, 862, 54, 139, 546, 542, 82, 100, 805, 724,
            732, 495, 551, 119, 891, 809, 325, 279, 307, 198, 219, 851, 165, 707, 253, 411, 8, 153, 505, 46, 97, 1022,
            769, 943, 660, 971, 96, 264, 401, 168, 493, 391, 499, 131, 677, 493, 985, 596, 990, 492, 972, 599, 598, 802,
            410, 416, 737, 365, 988, 512, 196, 334, 378, 437, 454, 522, 635, 320, 724, 345, 731, 114, 707, 868, 34, 1,
            508, 557, 279, 817, 846, 951, 639, 749, 753, 558, 798, 20, 822, 36, 458, 341, 880, 437, 535, 12, 817, 310,
            484, 651, 161, 863, 843, 412, 967, 794, 530, 535, 875, 722, 300, 93, 730, 395, 349, 145, 407, 166, 189, 1019,
            509, 278, 196, 357, 732, 188, 703, 257, 874, 181, 254, 444, 64, 524, 232, 917, 683, 492, 64, 470, 842, 923,
            287, 20, 866, 12, 876, 990, 939, 276, 532, 283, 253, 559, 605, 639, 661, 985, 336, 809, 109, 766, 318, 817,
            381, 506, 730, 49, 52, 81, 163, 583, 461, 459, 545, 209, 353, 861, 659, 408, 521, 212, 363, 355, 78, 155,
            908, 682, 725, 623, 957, 818, 115, 490, 503, 773, 197, 808, 962, 434, 102, 447, 395, 239, 649, 380, 274, 164,
            64, 33, 580, 366, 967, 219, 553, 441, 430, 576, 920, 252, 202, 403, 130, 643, 445, 53, 919, 433, 916, 236,
            203, 801, 1024, 417, 341, 986, 257, 859, 715, 882, 831, 833, 546, 586, 799, 312, 391, 165, 68, 705, 505, 392,
            324, 650, 450, 458, 307, 842, 300, 358, 163, 64, 419, 727, 914, 898, 683, 68, 985, 345, 119, 336, 157, 9, 97,
            333, 717, 132, 87, 873, 287, 649, 8, 68, 394, 393, 899, 607, 640, 780, 796, 240, 334, 820, 400, 571, 901, 85,
            87, 279, 372, 148, 475, 957, 632, 577, 787, 990, 596, 521, 805, 536, 578, 313, 776, 162, 860, 675, 298, 214,
            784, 110, 219, 90, 479, 968, 275, 667, 703, 255, 199, 716, 71, 726, 125, 68, 347, 78, 993, 57, 109, 405, 690,
            294, 790, 250, 126, 848, 946, 967, 503, 957, 368, 550, 837, 658, 378, 547, 114, 328, 307, 110, 699, 127, 142,
            539, 253, 8, 403, 744, 72, 708
    };
    public final String textKey;
    public  final byte []key;
    public XOR(String key) {
        this.textKey = key;
        if (key.length()==0)
            key+="default";
        this.key = key.getBytes();

    }

    public void xor(byte []data)
    {
        for (int i = 0; i< data.length; ++i)
        {
            int id = (i% sf.length)%key.length;
            data[i] ^= key[id];
        }
    }
}
